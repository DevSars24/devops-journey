ğŸ“‚ Project Structure

Hereâ€™s how your project directory looks (example):
''' bash
my-multiservice-app/
â”£ ğŸ“‚ frontend/       # React/Vite app (client)
â”£ ğŸ“‚ backend/        # Node/Express API (server)
â”£ ğŸ“‚ database/       # (Optional: configs like init.sql)
â”£ ğŸ“œ docker-compose.yaml
â”£ ğŸ“œ .env


ğŸ‘‰ This structure is important because each service (frontend, backend, database) is isolated but can talk to each other via Docker networks.

ğŸ§© What is Docker Compose?

Instead of running multiple docker run ... commands manually, we can define all services in one file â†’ docker-compose.yaml.
This file acts like a blueprint for your entire application stack.
You run docker compose up â†’ and all services start together.
âš™ï¸ The Final docker-compose.yaml

Hereâ€™s the corrected version we discussed:

version: "3.8"

services:
  frontend:
    build: ./frontend
    ports: 
      - "3000:80"
    depends_on:
      - backend
    networks:
      - my-custom-network

  backend:
    build: ./backend
    ports:
      - "5001:5000"
    environment:
      DB_HOST: database
      DB_USER: postgres
      DB_PASS: password
      DB_NAME: postgres
    depends_on: 
      - database
    networks:
      - my-custom-network

  database:
    image: postgres:16-alpine
    restart: always
    environment:
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: password
      POSTGRES_DB: postgres
    volumes:
      - pgdata:/var/lib/postgresql/data
    networks:
      - my-custom-network

volumes:
  pgdata:

networks:
  my-custom-network:
    driver: bridge

ğŸ” Explaining Each Section
ğŸ·ï¸ version: "3.8"

Defines Docker Compose syntax version.

3.8 is stable and widely supported.

âš¡ services:

Each service = one container.

Here we have 3 services:

frontend (React/Vite)

backend (Node.js/Express)

database (Postgres)

ğŸ¨ frontend Service
frontend:
  build: ./frontend
  ports: 
    - "3000:80"
  depends_on:
    - backend
  networks:
    - my-custom-network


build: ./frontend â†’ Looks for a Dockerfile inside frontend/ folder.

ports: "3000:80" â†’ Maps local http://localhost:3000 â†’ containerâ€™s port 80.

depends_on â†’ Starts backend first before frontend.

networks â†’ Connected to our custom network.

âš™ï¸ backend Service
backend:
  build: ./backend
  ports:
    - "5001:5000"
  environment:
    DB_HOST: database
    DB_USER: postgres
    DB_PASS: password
    DB_NAME: postgres
  depends_on: 
    - database
  networks:
    - my-custom-network


build: ./backend â†’ Dockerfile in backend/ builds Node/Express server.

ports: "5001:5000" â†’ Localhost 5001 â†’ Containerâ€™s internal API port 5000.

environment: â†’ Pass DB configs to backend (it will use these in code).

depends_on: database â†’ Makes sure Postgres starts before backend.

ğŸ›¢ï¸ database Service
database:
  image: postgres:16-alpine
  restart: always
  environment:
    POSTGRES_USER: postgres
    POSTGRES_PASSWORD: password
    POSTGRES_DB: postgres
  volumes:
    - pgdata:/var/lib/postgresql/data
  networks:
    - my-custom-network


image: postgres:16-alpine â†’ Uses lightweight Postgres DB image.
restart: always â†’ Ensures DB container restarts if it crashes.
environment: â†’ Creates DB with username, password, and database name.
volumes: â†’ Stores DB data in pgdata â†’ so data isnâ€™t lost when container restarts.

networks: â†’ Part of our app network.

ğŸ’¾ volumes
volumes:
  pgdata:

Named volume â†’ persists DB data outside container.

ğŸŒ networks
networks:
  my-custom-network:
    driver: bridge


Custom bridge network â†’ allows containers to talk to each other by name (database, backend, etc.).

âš¡ How Things Work Together

Database (Postgres) starts first â†’ provides persistent DB.
Backend (Node/Express) connects to Postgres using env vars (DB_HOST=database).
Frontend (React/Vite) talks to backend API (http://backend:5000).
All containers talk internally over my-custom-network.

â–¶ï¸ Run the Whole Stack
docker compose up --build

--build ensures changes in Dockerfiles are applied.

Now:
Frontend â†’ http://localhost:3000
Backend API â†’ http://localhost:5001

Database runs internally on Postgres default port.
